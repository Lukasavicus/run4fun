{"version":3,"sources":["../../app-es6/services/ProxyFactory.js"],"names":["ProxyFactory","objeto","options","Proxy","get","target","prop","receiver","option","filter","props","includes","undefined","_ehFuncao","applicability","action","retorno","Reflect","apply","arguments","bind","set","value","construct","args","object","that","console","log","getPrototypeOf","setPrototypeOf","prototype","isExtensible","func","Function"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oCAAaA,Y;;;;;;;2CAaKC,M,EAAQC,O,EAAS;AAC3B,6BAAKA,OAAL,GAAeA,OAAf;AACA;AACA;;AAEA,+BAAO,IAAIC,KAAJ,CAAUF,MAAV,EAAkB;AACjBG,+BADiB,eACbC,MADa,EACLC,IADK,EACCC,QADD,EACW;AACxB;AACA,oCAAIC,SAASN,QAAQO,MAAR,CAAe;AAAA,2CAAWD,OAAOE,KAAP,CAAaC,QAAb,CAAsBL,IAAtB,CAAX;AAAA,iCAAf,EAAwD,CAAxD,CAAb;AACA;;AAEA;AACA;;AAEA,oCAAGE,UAAUI,SAAV,IAAuBZ,aAAaa,SAAb,CAAuBR,OAAOC,IAAP,CAAvB,CAA1B,EAAgE;AAC5D;AACA,2CAAO,YAAW;AACd;AACA,4CAAG,CAAC,QAAD,EAAW,MAAX,EAAmBK,QAAnB,CAA4BH,OAAOM,aAAnC,CAAH,EAAqD;AACjD;AACA;AACA;AACA;AACAN,mDAAOO,MAAP,CAAcV,MAAd;AACH;AACD;AACA,4CAAIW,UAAUC,QAAQC,KAAR,CAAcb,OAAOC,IAAP,CAAd,EAA4BD,MAA5B,EAAoCc,SAApC,CAAd;AACA;AACA,4CAAG,CAAC,OAAD,EAAU,MAAV,EAAkBR,QAAlB,CAA2BH,OAAOM,aAAlC,CAAH,EAAoD;AAChD;AACAN,mDAAOO,MAAP,CAAcV,MAAd;AACH;AACD,+CAAOW,OAAP;AACH,qCAjBD;AAkBH;;AAED,oCAAGhB,aAAaa,SAAb,CAAuBR,OAAOC,IAAP,CAAvB,CAAH,EAAwC;AACpC;AACA,2CAAQW,QAAQb,GAAR,CAAYC,MAAZ,EAAoBC,IAApB,EAA0BC,QAA1B,CAAD,CAAsCa,IAAtC,CAA2Cf,MAA3C,CAAP;AACH,iCAHD,MAII;AACA;AACA,2CAAOA,OAAOC,IAAP,CAAP;AACH;AACJ,6BAvCgB;AAyCjBe,+BAzCiB,eAyCbhB,MAzCa,EAyCLC,IAzCK,EAyCCgB,KAzCD,EAyCQf,QAzCR,EAyCkB;AAC/B,oCAAIC,SAASN,QAAQO,MAAR,CAAe;AAAA,2CAAWD,OAAOE,KAAP,CAAaC,QAAb,CAAsBL,IAAtB,CAAX;AAAA,iCAAf,EAAwD,CAAxD,CAAb;AACA;AACA;;AAEA,oCAAIU,UAAWX,OAAOC,IAAP,IAAegB,KAA9B;;AAEA,oCAAGd,UAAUI,SAAb,EACIJ,OAAOO,MAAP,CAAcV,MAAd;;AAEJ,uCAAOW,OAAP;AACH,6BApDgB;;;AAsDjB;AACAO,uCAAW,mBAASlB,MAAT,EAAiBmB,IAAjB,EAAuB;AAC9B;AACA,oCAAIC,4CAAapB,MAAb,mCAAuBmB,IAAvB,MAAJ;AACAtB,wCAAQ,CAAR,EAAWa,MAAX,CAAkBU,MAAlB;AACA,uCAAOA,MAAP;AACH,6BA5DgB;AA6DjBP,mCAAO,eAASb,MAAT,EAAiBqB,IAAjB,EAAuBF,IAAvB,EAA6B;AAChCG,wCAAQC,GAAR,CAAY,qBAAZ;AACA;AACA;AACH,6BAjEgB;AAkEjBC,0CAlEiB,0BAkEFxB,MAlEE,EAkEM;AACnBsB,wCAAQC,GAAR,CAAY,2BAAZ;AACA;AACH,6BArEgB;;AAsEjBE,4CAAgB,wBAASzB,MAAT,EAAiB0B,SAAjB,EAA4B;AACxCJ,wCAAQC,GAAR,CAAY,2BAAZ;AACH,6BAxEgB;AAyEjBI,0CAAc,sBAAS3B,MAAT,EAAiB;AAC3BsB,wCAAQC,GAAR,CAAY,yBAAZ;AACH;AA3EgB,yBAAlB,CAAP;AA6EH;;;8CAEgBK,I,EAAM;AACnB,+BAAO,QAAOA,IAAP,yCAAOA,IAAP,cAAuBC,QAAvB,yCAAuBA,QAAvB,EAAP;AACH","file":"ProxyFactory.js","sourcesContent":["export class ProxyFactory {\r\n    \r\n    /*\r\n     * :applicability: parametro responsavel por controlar a aplicação da(s) ação(ões)\r\n     * das funções de armadilha. Valores possíveis e exemplos:\r\n     * \"antes\": aplica a função antes da chamada do parâmetro\r\n     * \"depois\": aplica a função depois da chamada do parâmetro\r\n     * \"ambos\": aplica a função antes e depois da chamada do parâmetro\r\n     */\r\n     //static create(objeto, props, action, applicability, other_action) {\r\n\r\n    //static options = [];\r\n\r\n    static create(objeto, options) {\r\n        this.options = options;\r\n        //console.log(\"new Proxy for:\", objeto);\r\n        //console.log('options', options);\r\n\r\n        return new Proxy(objeto, {\r\n                get(target, prop, receiver) {\r\n                    //let option = ProxyFactory._get_option_by_property(prop);\r\n                    let option = options.filter(option => (option.props.includes(prop)))[0];\r\n                    //console.log('option', option, 'prop', prop);\r\n\r\n                    // if(prop == 'send')\r\n                    //     console.log('here comes the send');\r\n\r\n                    if(option != undefined && ProxyFactory._ehFuncao(target[prop])) {\r\n                        //console.log(\"entrou\");\r\n                        return function() {\r\n                            // before_action\r\n                            if(['before', 'both'].includes(option.applicability)){\r\n                                //console.log('calling action before');\r\n                                // console.log('where is RequestFactory? ');\r\n                                // console.log('target', target);\r\n                                // console.log('receiver', receiver);\r\n                                option.action(target);\r\n                            }\r\n                            //console.log('calling prop->target');\r\n                            let retorno = Reflect.apply(target[prop], target, arguments);\r\n                            // after_effects\r\n                            if(['after', 'both'].includes(option.applicability)){\r\n                                //console.log('calling action after', option.action, target);\r\n                                option.action(target);\r\n                            }\r\n                            return retorno;\r\n                        }\r\n                    }\r\n\r\n                    if(ProxyFactory._ehFuncao(target[prop])){\r\n                        // console.log('Esta funcao foi chamada: ', prop);\r\n                        return (Reflect.get(target, prop, receiver)).bind(target);\r\n                    }\r\n                    else{\r\n                        // console.log('Esta propriedade foi chamada: ', prop);\r\n                        return target[prop];\r\n                    }\r\n                },\r\n                \r\n                set(target, prop, value, receiver) {\r\n                    let option = options.filter(option => (option.props.includes(prop)))[0];\r\n                    // console.log('option', option, 'prop', prop);\r\n                    // console.log('Esta propriedade foi setada: ', prop);\r\n\r\n                    let retorno = (target[prop] = value);\r\n\r\n                    if(option != undefined)\r\n                        option.action(target);\r\n\r\n                    return retorno;\r\n                },\r\n\r\n                // other handlers\r\n                construct: function(target, args) {\r\n                    // console.log('HANDLERS - constructing');\r\n                    let object = new target(...args);\r\n                    options[0].action(object)\r\n                    return object;\r\n                },\r\n                apply: function(target, that, args) {\r\n                    console.log('HANDLERS - applying');\r\n                    // sup.apply(that, args);\r\n                    // base.apply(that, args);\r\n                },\r\n                getPrototypeOf(target) {\r\n                    console.log('HANDLERS - getPrototypeOf');\r\n                    //return monsterPrototype;\r\n                },\r\n                setPrototypeOf: function(target, prototype) {\r\n                    console.log('HANDLERS - setPrototypeOf');\r\n                },\r\n                isExtensible: function(target) {\r\n                    console.log('HANDLERS - isExtensible');\r\n                }\r\n        });\r\n    }\r\n    \r\n    static _ehFuncao(func) {\r\n        return typeof(func) == typeof(Function);\r\n    }\r\n\r\n    // static _get_option_by_property(property){\r\n    //     console.log('searching on', property, this.options);\r\n    //     return this.options.filter(option => (option.props.includes(property)))[0];\r\n    // }\r\n}\r\n\r\n    /* \r\n     * Usage example:\r\n\r\n     this._request_proxy = ProxyFactory.create(\r\n\t\t\tnew XMLHttpRequest(), [\r\n\t\t\t\t{'props' : ['send', 'upload'], 'action' : this._on_request.bind(this), 'applicability' : \"before\"},\r\n\t\t\t\t{'props' : ['ontimeout'], 'action' : this._on_requestError.bind(this), 'applicability' : \"before\"},\r\n\t\t\t\t//{'props' : ['onload', 'onloadend', 'onprogress'], 'action' : this._on_response.bind(this), 'applicability' : \"before\"},\r\n\t\t\t\t//{'props' : ['onload', 'onloadend', 'onprogress'], 'action' : this._on_response.bind(this), 'applicability' : \"after\"},\r\n\t\t\t\t{'props' : ['onreadystatechange'], 'action' : this._on_response.bind(this), 'applicability' : \"before\"},\r\n\t\t\t\t{'props' : ['onerror'], 'action' : this._on_responseError.bind(this), 'applicability' : \"before\"},\r\n\t\t]);\r\n\r\n     */"]}